:PROPERTIES:
:ID:       0d061b3f-f871-4c7c-814d-472f4995c7a6
:ROAM_REFS: https://rust-unofficial.github.io/too-many-lists
:END:
#+title: Rust linked list

* =.as_ref()=
The correct way to handle this is with the as_ref method on Option, which has the following definition:
#+begin_src rust
impl<T> Option<T> {
    pub fn as_ref(&self) -> Option<&T>;
}
#+end_src
It demotes the Option to an Option to a reference to its internals. We could do this ourselves with an explicit match but ugh no. It does mean that we need to do an extra dereference to cut through the extra indirection, but thankfully the . operator handles that for us.
#+begin_src rust
pub fn peek(&self) -> Option<&T> {
    self.head.as_ref().map(|node| {
        &node.elem
    })
}
#+end_src
